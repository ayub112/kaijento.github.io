<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/stylesheets/shiori.css">
    <link rel="canonical" href="http://kaijento.github.io/2017/05/08/web-scraping-imgur.com/">
    <link rel="shortcut icon" href="/favicon.ico">
    <title>Web scraping: imgur.com | Shiori</title>
    
  </head>
  <body>

    <div class="navbar navbar-default navbar-static-top">

      <div class="container">
        <div class="navbar-header">
          <a href="/" class="navbar-brand">Shiori</a>
        </div>
        <div>
            <ul class="navbar-nav nav">
            <li><a href="/archive/">articles</a></li>
<li><a href="/categories/">categories</a></li>
<li><a href="/me/">me</a></li>
<li><a href="/feed.xml">rss</a></li>

          </ul>
          <ul class="navbar-nav nav navbar-right">
            <li><a href="https://twitter.com/kaijento">@kaijento</a></li>
<li><a href="https://github.com/kaijento">
    <svg height="18" viewBox="0 0 16 16" class="octicon-mark-github" version="1.1" width="24"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg>
  </a>
</li>

          </ul>
        </div>
      </div>
    </div>
    
    <div class="container post-body">
    
      <div class="row">
        
          <div class="col-sm-12">
            <div class="post-header">
  <!-- Emoji is not available outside markdown files, so using "include ribbon.html" instead -->
<img class="emoji" title=":ribbon:" alt=":ribbon:" src="/img/1f380.png" height="20" width="20" align="absmiddle">

  <h1 class="post-title-main"><a href="/2017/05/08/web-scraping-imgur.com/">Web scraping: imgur.com</a></h1>
  <p class="text-muted">08 May 2017</p>

<p class="text-right preview">
  
    
  <a href="/categories/python/">python</a>
  
    
  <a href="/categories/webscraping/">webscraping</a>
  
    
  <a href="/categories/requests/">requests</a>
  
    
  <a href="/categories/beautifulsoup/">beautifulsoup</a>
  
    
  <a href="/categories/curl/">curl</a>
  
</p>


</div>
<div class="post-content">
  <p><em>I’m trying to “scrape” images from Imgur 
using BeautifulSoup and requests but I’m only getting the
first page of results. Why?</em></p>

<p>The example URL we’re given is <a href="http://imgur.com/r/funny">http://imgur.com/r/funny</a></p>

<p>So <code class="highlighter-rouge">requests</code> is being used to fetch the HTML and <code class="highlighter-rouge">BeautifulSoup</code>
with <code class="highlighter-rouge">html5lib</code> to parse the HTML.</p>

<p>If you don’t have these install already you can use install them
using <code class="highlighter-rouge">pip</code> e.g.</p>

<p><code class="highlighter-rouge">pip install beautifulsoup4 requests html5lib --user</code></p>

<a name="developer-tools"></a>
<h2 class="section-header">
  <span id="developer-tools"></span>
  <a class="anchor" href="#developer-tools">“Developer Tools”</a>
</h2>

<p>Usually the first step to take is to debug the page in question
inside your browser using the <em>“Developer Tools”</em> (although 
currently it seems to called <em>“Web Developer”</em> in <code class="highlighter-rouge">Firefox</code>) mainly 
the <code class="highlighter-rouge">Inspector</code> tab and the <code class="highlighter-rouge">Network</code> tab.</p>

<p>So normally when you scroll down to the end of an <em>Imgur</em> results
page it will automatically load the next page of images.</p>

<p>I’m using <code class="highlighter-rouge">Firefox</code> as my browser (although <code class="highlighter-rouge">Chrome</code> also has 
<em>“Developer Tools”</em>) with Javascript disabled
(using the <code class="highlighter-rouge">NoScript</code> extension) so when I scroll to the
end of the page I see a <em>“loading”</em> icon.</p>

<p><img src="/img/1494227189-imgur-loading.png" alt="" /></p>

<p>This means that the <em>“load next page”</em> functionality
is implemented using Javascript. Neither <code class="highlighter-rouge">requests</code> 
nor the <code class="highlighter-rouge">urllib</code> modules can execute Javascript meaning
we will only get the first page of results when
using them to fetch the HTML.</p>

<p>One option is to debug the HTTP requests being made
by the Javascript and try to replicate them with <code class="highlighter-rouge">requests</code>.</p>

<p>To debug HTTP requests we can view the <code class="highlighter-rouge">Network</code> tab.</p>

<p>You may have heard of the <code class="highlighter-rouge">Inspector</code> tab which you can 
access by <em>right-clicking</em> on a page and selecting 
<code class="highlighter-rouge">Inspect Element</code>.</p>

<p><img src="/img/1494227500-imgur-inspect-element.png" alt="" /></p>

<p>From there we can select the <code class="highlighter-rouge">Network</code> tab.</p>

<p><img src="/img/1494227380-imgur-network-xhr.png" alt="" /></p>

<p>After opening the <code class="highlighter-rouge">Network</code> tab I have selected the <code class="highlighter-rouge">XHR</code> filter
to show only those type of requests. This stands for <code class="highlighter-rouge">XMLHttpRequest</code>
which is what the requests made by Javascript are classed as.</p>

<p>As we know the page is using Javascript to fetch the data we know
it will be an <code class="highlighter-rouge">XHR</code> request so viewing only those requests will
simplify things.</p>

<p>I then enable Javascript (as I have it disabled) and reload the page.
The <code class="highlighter-rouge">Network</code> tab will only show requests that have been made after it was
opened.</p>

<p>So we can see a <code class="highlighter-rouge">GET</code> request was made to 
<a href="http://imgur.com/r/funny/new/page/1/hit?scrolled">http://imgur.com/r/funny/new/page/1/hit?scrolled</a>
and its return type was <code class="highlighter-rouge">html</code>.</p>

<p>If we scroll down further we will see another <code class="highlighter-rouge">GET</code> request is made to 
<a href="http://imgur.com/r/funny/new/page/2/hit?scrolled">http://imgur.com/r/funny/new/page/2/hit?scrolled</a></p>

<p>All that changes in the URL is the page number i.e. <code class="highlighter-rouge">1 -&gt; 2</code> and as <code class="highlighter-rouge">1</code> gives 
us the second page of results we can assume that <code class="highlighter-rouge">0</code> will gives us the first i.e.</p>

<p><a href="http://imgur.com/r/funny/new/page/0/hit?scrolled">http://imgur.com/r/funny/new/page/0/hit?scrolled</a></p>

<p>From within the <code class="highlighter-rouge">Network</code> tab you can <em>right-click</em> on a request and <code class="highlighter-rouge">Copy as cURL</code>
which will give you the full <code class="highlighter-rouge">curl</code> command that can be used to replicate the
request which can be very useful for testing things out from the command-line.</p>

<p><img src="/img/1494228610-imgur-copy-as-curl.png" alt="" /></p>

<p>We can add <code class="highlighter-rouge">-o filename</code> to the end of the command to store the output into <code class="highlighter-rouge">filename</code>
instead of just printing the result.</p>

<p>Using the exact command is not always necessary but at the very least you will want 
to set the <code class="highlighter-rouge">User-Agent</code> header which is what we’ll do here.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>curl -A Mozilla/5.0 <span class="s1">'http://imgur.com/r/funny/new/page/0/hit?scrolled'</span> -o imgur.html
</code></pre>
</div>

<p>You could of course use <code class="highlighter-rouge">requests</code> to fetch the HTML 
(or <a href="https://github.com/jakubroztocil/httpie">httpie</a>) and save it.</p>

<p>So now that we have the HTML saved to a local file we can open it up in our editor
to view it.</p>

<div class="language-html highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"posts sub-gallery br5 first-child"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"imagelist-header scrolled"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h1</span> <span class="na">class=</span><span class="s">"image-list-header-name"</span><span class="nt">&gt;</span>r/funny<span class="nt">&lt;/h1&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"b0hgL"</span> <span class="na">class=</span><span class="s">"post"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;a</span> <span class="na">class=</span><span class="s">"image-list-link"</span> <span class="na">href=</span><span class="s">"/r/funny/b0hgL"</span> <span class="na">data-page=</span><span class="s">"0"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;img</span> <span class="na">alt=</span><span class="s">""</span> <span class="na">src=</span><span class="s">"//i.imgur.com/WZxfBPmb.jpg"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"hover"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;p&gt;</span>Riding doggo<span class="nt">&lt;/p&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"post-info"</span><span class="nt">&gt;</span>
        album <span class="ni">&amp;middot;</span> 279,116 views
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre>
</div>

<p>So it looks like we can isolate each image entry with by their <code class="highlighter-rouge">class</code> 
attribute <code class="highlighter-rouge">class="post"</code> which can be done easily using a <em>CSS Selector</em>.</p>

<a name="beautifulsoup"></a>
<h2 class="section-header">
  <span id="beautifulsoup"></span>
  <a class="anchor" href="#beautifulsoup">BeautifulSoup</a>
</h2>

<p>To use <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#css-selectors">CSS Selectors</a> 
within <code class="highlighter-rouge">BeautifulSoup</code> there is <code class="highlighter-rouge">select()</code> which
will return a list of all matches and <code class="highlighter-rouge">select_one()</code> which will return the
first match.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'imgur.html'</span><span class="p">)</span> <span class="k">as</span> <span class="n">html</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s">'html5lib'</span><span class="p">)</span>
<span class="o">...</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s">"post"</span> <span class="nb">id</span><span class="o">=</span><span class="s">"b0hgL"</span><span class="o">&gt;</span>\<span class="n">n</span><span class="o">&lt;</span><span class="n">a</span> <span class="n">class</span><span class="o">=</span><span class="s">"image-list-link"</span> <span class="o">...</span>
</code></pre>
</div>

<p>So the CSS Selector <code class="highlighter-rouge">.post</code> will find any tag that has <code class="highlighter-rouge">post</code> as a class
attribute word.</p>

<p>We could be more explicit and specify the tag
e.g. <code class="highlighter-rouge">div.post</code> which would only search <code class="highlighter-rouge">&lt;div&gt;</code> tags however
there are no other tags that have a <code class="highlighter-rouge">post</code> class.</p>

<p>From there we can navigate to the <code class="highlighter-rouge">&lt;img&gt;</code> tag to extract the
<code class="highlighter-rouge">src</code> attribute.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span><span class="o">.</span><span class="n">img</span>
<span class="o">&lt;</span><span class="n">img</span> <span class="n">alt</span><span class="o">=</span><span class="s">""</span> <span class="n">src</span><span class="o">=</span><span class="s">"//i.imgur.com/WZxfBPmb.jpg"</span><span class="o">/&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span><span class="o">.</span><span class="n">img</span><span class="p">[</span><span class="s">'src'</span><span class="p">]</span>
<span class="s">'//i.imgur.com/WZxfBPmb.jpg'</span>
</code></pre>
</div>

<p><code class="highlighter-rouge">BeautifulSoup</code> allows you to navigate
down using attributes e.g. <code class="highlighter-rouge">.img</code> which is equivalent to
calling <code class="highlighter-rouge">find('img')</code> and <em>dict indexing</em> can be used
to access the values from the tag attributes.</p>

<p>We could also navigate down to extract the title and the number of
views if desired.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span><span class="o">.</span><span class="n">div</span>
<span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s">"hover"</span><span class="o">&gt;</span>\<span class="n">n</span><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Riding</span> <span class="n">doggo</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>\<span class="n">n</span><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s">"post-info"</span><span class="o">&gt;</span>\<span class="n">nalbum</span> \<span class="n">xb7</span> <span class="mi">279</span><span class="p">,</span><span class="mi">116</span> <span class="n">views</span>\<span class="n">n</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>\<span class="n">n</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">p</span>
<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Riding</span> <span class="n">doggo</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">text</span>
<span class="s">'Riding doggo'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">div</span>
<span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s">"post-info"</span><span class="o">&gt;</span>\<span class="n">n</span>        <span class="n">album</span> \<span class="n">xb7</span> <span class="mi">279</span><span class="p">,</span><span class="mi">116</span> <span class="n">views</span>\<span class="n">n</span>      <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</code></pre>
</div>

<p>To extract the number of views however would probably require regex.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">re</span>
<span class="o">&gt;&gt;&gt;</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">text</span>
<span class="s">'</span><span class="se">\n</span><span class="s">        album </span><span class="se">\xb7</span><span class="s"> 279,116 views</span><span class="se">\n</span><span class="s">      '</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">r'</span><span class="err">\</span><span class="s">S+(?= views)'</span><span class="p">,</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<span class="s">'279,116'</span>
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">\S</code> matches a non-whitespace character</li>
  <li><code class="highlighter-rouge">+</code> means the previous <em>“atom”</em> (in this case <code class="highlighter-rouge">\S</code>) <em>1 or more times</em></li>
  <li><code class="highlighter-rouge">(?=)</code> is a <em>positive lookahead assertion</em> which allows you to specify
that something must follow but it is not included in the match (or captured)</li>
</ul>

<p>This allows us to match the <em>“word”</em> that comes before <code class="highlighter-rouge">views</code> in the text which
is the number of views.</p>

<p>We could also use <code class="highlighter-rouge">split()</code> but assuming word position could be considered
a more <em>“fragile”</em> approach.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="p">[</span><span class="s">'album'</span><span class="p">,</span> <span class="s">'</span><span class="se">\xb7</span><span class="s">'</span><span class="p">,</span> <span class="s">'279,116'</span><span class="p">,</span> <span class="s">'views'</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">soup</span><span class="o">.</span><span class="n">select_one</span><span class="p">(</span><span class="s">'.post'</span><span class="p">)</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="s">'279,116'</span>
</code></pre>
</div>

<a name="code"></a>
<h2 class="section-header">
  <span id="code"></span>
  <a class="anchor" href="#code">Code</a>
</h2>

<p>Now that we know what requests to make and how to extract the required 
information for each image let’s write some code.</p>

<p>First though we will show some example output.</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>python imgur.py 
url:    http://i.imgur.com/WZxfBPmb.jpg
title:  Riding doggo
views:  302,993
url:    http://i.imgur.com/NlxYcfeb.jpg
title:  Super Dissed
views:  262,927
url:    http://i.imgur.com/H3iyVykb.jpg
title:  Introducing the undisputed heavyweight champ of the world...
views:  153,290
url:    http://i.imgur.com/IjRZgkVb.jpg
title:  Essentially Covers It All
views:  34,400
url:    http://i.imgur.com/Hyy0WRAb.jpg
title:  Hair Cutting <span class="k">for </span>Ex Wedding
views:  431,877
<span class="o">[</span>...]
</code></pre>
</div>

<p>The code that generated it.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">requests</span>
<span class="kn">from</span>   <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">api</span> <span class="o">=</span> <span class="s">'http://imgur.com/r/funny/new/page/{}/hit?scrolled'</span>

<span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="n">s</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">'user-agent'</span><span class="p">]</span> <span class="o">=</span> <span class="s">'Mozilla/5.0'</span>

    <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">r</span>    <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">api</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">page</span><span class="p">))</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s">'html5lib'</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">post</span> <span class="ow">in</span> <span class="n">soup</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s">'.post'</span><span class="p">):</span>
            <span class="n">url</span>   <span class="o">=</span> <span class="s">'http:'</span> <span class="o">+</span> <span class="n">post</span><span class="o">.</span><span class="n">img</span><span class="p">[</span><span class="s">'src'</span><span class="p">]</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">post</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">text</span>
            <span class="n">views</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s">r'</span><span class="err">\</span><span class="s">S+(?= views)'</span><span class="p">,</span> <span class="n">post</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">div</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'url:   '</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'title: '</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'views: '</span><span class="p">,</span> <span class="n">views</span><span class="p">)</span>
</code></pre>
</div>

<p>The <code class="highlighter-rouge"><span class="p">{}</span></code> in <code class="highlighter-rouge">api</code> is a <em>placeholder</em> for use with 
<a href="https://docs.python.org/3/library/stdtypes.html#str.format">str.format()</a>.</p>

<p>It gets replaced with what we pass in e.g.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">api</span> <span class="o">=</span> <span class="s">'http://imgur.com/r/funny/new/page/{}/hit?scrolled'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="s">'http://imgur.com/r/funny/new/page/1/hit?scrolled'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">api</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="s">'http://imgur.com/r/funny/new/page/2/hit?scrolled'</span>
</code></pre>
</div>

<p>This is a simple way for us to build the needed URLs to use
for our requests.</p>

<p>When making multiple requests with <code class="highlighter-rouge">requests</code> you’ll usually want to use a 
<a href="http://docs.python-requests.org/en/latest/user/advanced/#session-objects">session object</a>
to maintain <em>“state”</em> and keep track of cookies.</p>

<p>You’ll also pretty much always want to set the <code class="highlighter-rouge">User-Agent</code> header 
which we set here to <code class="highlighter-rouge">Mozilla/5.0</code> as the default <code class="highlighter-rouge">User-Agent</code> will
often be blocked.</p>

<p>The rest of the code is just fetching each page (we’ve used the first two
pages in this example), building our <code class="highlighter-rouge">BeautifulSoup</code> objects and extracting
the data which has already been explained however we’re now using <code class="highlighter-rouge">select()</code>
to process all of the images per page.</p>

<p>The final goal is probably to save the images to disk which you could 
implement <a href="http://docs.python-requests.org/en/latest/user/quickstart/#raw-response-content">using requests</a>.</p>

</div>

  
    <div class="post-navs row">
      
        <div class="col-md-6 post-nav">
          <h3 class="section-header">
            Older
            <!--<span class="text-muted"> &middot; </span>-->
            <a href="/archive">View Archive (49)</a>
          </h3>
          <h2 class="post-title-link"><a href="/2017/05/06/web-scraping-nasa-image-of-the-day/">Web scraping: NASA Image of the Day</a></h2>
          <p class="preview">The goal is trying to <em>“scrape”</em> images from 
<a href="https://www.nasa.gov/multimedia/imagegallery/iotd.html">NASA’s Image of the Day page</a> 
using Python’s <code class="highlighter-rouge">BeautifulSoup</code> module. The images 
are there when I look in the <code class="highlighter-rouge">Inspector</code> tab but they’re
not there when I fetch the page using <code class="highlighter-rouge">requests</code>. What am
I doing wrong?</p>


        </div>
      
      
    </div>
  

<div class="post-footer">
  <center><strong>Hello? Is it me you're looking for?</strong> 
<p>
  <a href="mailto:karl.genockey.thornton@gmail.com">e-mail</a>
  <a href="https://github.com/kaijento">github</a>
  <strong>♥</strong> 
  <a href="https://paypal.me/kaijento">paypal</a>
  <a href="https://twitter.com/kaijento">twitter</a> 
</p>
<p>
<small>1GVHM3rfQ46k15RZsfnE4xzmKk7NCFwRaT</small>
</p>
</center>

</div>

          </div>
        
      </div>
      <div class="row footer">
        <div class="col-sm-12 text-center">
          &copy;2017.
Built with <a href="http://jekyllrb.com/">Jekyll</a> and
<a href="https://github.com/ellekasai/shiori">Shiori Theme</a>.

        </div>
      </div>
    </div>
    
  </body>
</html>
